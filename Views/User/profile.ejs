<%- include('header.ejs') %>


    <main class="main">
        <div class="page-header breadcrumb-wrap">
            <div class="container">
                <div class="breadcrumb">
                    <a href="/home" rel="nofollow">Home</a>
                    <span></span> Account
                </div>
            </div>
        </div>
        <section class="pt-150 pb-150">
            <div class="container">
                <div class="row">
                    <div class="col-lg-10 m-auto">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="dashboard-menu">
                                    <ul class="nav flex-column" role="tablist">
                                        <li class="nav-item">
                                            <a class="nav-link active" href="/profile"><i
                                                    class="fi-rs-user mr-10"></i>Profile</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" href="/home/account/myOrders"><i
                                                    class="fi-rs-shopping-bag mr-10"></i>Orders</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" href="/address"><i class="fi-rs-marker mr-10"></i>My
                                                Address</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" href="home/account/wallet"><i
                                                    class="fa-solid fa-wallet mr-10"></i>Wallet</a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" href="/logout"><i
                                                    class="fi-rs-sign-out mr-10"></i>Logout</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                            <div class="col-md-8">
                                <div class="tab-content dashboard-content">
                                    <!-- <div class="tab-pane fade" id="orders" role="tabpanel" aria-labelledby="orders-tab">
                                        <div class="card">
                                            <div class="card-header">
                                                <h5 class="mb-0">Your Orders</h5>
                                            </div>
                                            <div class="card-body">
                                                <div class="table-responsive">
                                                    <table class="table">
                                                        <thead>
                                                            <tr>
                                                                <th>Order</th>
                                                                <th>Date</th>
                                                                <th>Status</th>
                                                                <th>Total</th>
                                                                <th>Actions</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <tr>
                                                                <td>#1357</td>
                                                                <td>March 45, 2020</td>
                                                                <td>Processing</td>
                                                                <td>$125.00 for 2 item</td>
                                                                <td><a href="#" class="btn-small d-block">View</a></td>
                                                            </tr>
                                                            <tr>
                                                                <td>#2468</td>
                                                                <td>June 29, 2020</td>
                                                                <td>Completed</td>
                                                                <td>$364.00 for 5 item</td>
                                                                <td><a href="#" class="btn-small d-block">View</a></td>
                                                            </tr>
                                                            <tr>
                                                                <td>#2366</td>
                                                                <td>August 02, 2020</td>
                                                                <td>Completed</td>
                                                                <td>$280.00 for 3 item</td>
                                                                <td><a href="#" class="btn-small d-block">View</a></td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </div> -->

                                    <!-- <div class="tab-pane fade" id="address" role="tabpanel"
                                        aria-labelledby="address-tab">
                                        <div class="row">
                                            <div class="col-lg-6">
                                                <div class="card mb-3 mb-lg-0">
                                                    <div class="card-header">
                                                        <h5 class="mb-0">Billing Address</h5>
                                                    </div>
                                                    <div class="card-body">
                                                        <address>3522 Interstate<br> 75 Business Spur,<br> Sault Ste.
                                                            <br>Marie, MI 49783
                                                        </address>
                                                        <p>New York</p>
                                                        <a href="#" class="btn-small">Edit</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-lg-6">
                                                <div class="card">
                                                    <div class="card-header">
                                                        <h5 class="mb-0">Shipping Address</h5>
                                                    </div>
                                                    <div class="card-body">
                                                        <address>4299 Express Lane<br>
                                                            Sarasota, <br>FL 34249 USA <br>Phone: 1.941.227.4444
                                                        </address>
                                                        <p>Sarasota</p>
                                                        <a href="#" class="btn-small">Edit</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div> -->
                                    <div class="tab-pane fade active show" id="account-detail" role="tabpanel"
                                        aria-labelledby="account-detail-tab">
                                        <div class="card">
                                            <div class="card-header">
                                                <h5>Profile Details</h5>
                                            </div>
                                            <div class="card-body">
                                                <!-- <p>Already have an account? <a href="page-login-register.html">Log in instead!</a></p> -->
                                                <form method="post" name="enq" action="/edit-profile/<%= user._id %>"
                                                    onsubmit="return validateProfileForm()">
                                                    <div class="row">
                                                        <div class="form-group col-md-12">
                                                            <label>Email Address <span class="required">*</span></label>
                                                            <input class="form-control square" id="email" name="email"
                                                                type="email" value="<%= user.email %>"
                                                                placeholder="Email" disabled>

                                                        </div>
                                                        <div class="form-group col-md-12">
                                                            <label>Name <span class="required">*</span></label>
                                                            <input required="" class="form-control square" id="name"
                                                                name="name" type="text" value="<%= user.name %>"
                                                                placeholder="Name">
                                                            <small id="nameError" class="text-danger"></small>
                                                        </div>
                                                        <div class="form-group col-md-12">
                                                            <label>Phone Number <span class="required">*</span></label>
                                                            <input required="" class="form-control square" id="phno"
                                                                name="phno" type="tel" value="<%= user.phno %>"
                                                                placeholder="Phone number">
                                                            <small id="phoneError" class="text-danger"></small>
                                                        </div>
                                                        <div class="col-md-12">
                                                            <button type="submit" class="btn btn-fill-out submit"
                                                                name="submit" value="Submit">Update</button>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                        <br>
                                        <hr>
                                        <br>
                                        <div class="card">
                                            <div class="card-header">
                                                <h5>Change Password</h5>
                                            </div>
                                            <p style="color: red; font-size: 13px;">
                                                <%= matchPswd %>
                                                    <%= sameOldPswd %>
                                            </p>
                                            <div class="card-body">
                                                <form method="post" name="enq"
                                                    action="/profile-changePswd/<%= user._id %>"
                                                    onsubmit="return validatePasswordForm()">
                                                    <div class="row">
                                                        <div class="form-group col-md-12">
                                                            <label>Current Password <span
                                                                    class="required">*</span></label>
                                                            <input required="" class="form-control square" id="pswd"
                                                                name="pswd" type="password"
                                                                placeholder="Current Password">
                                                            <small id="pswdError" class="text-danger"></small>
                                                        </div>
                                                        <div class="form-group col-md-12">
                                                            <label>New Password <span class="required">*</span></label>
                                                            <input required="" class="form-control square" id="newPswd"
                                                                name="newPswd" type="password"
                                                                placeholder="New Password">
                                                            <small id="newPswdError" class="text-danger"></small>
                                                        </div>
                                                        <div class="form-group col-md-12">
                                                            <label>Confirm New Password <span
                                                                    class="required">*</span></label>
                                                            <input required="" class="form-control square"
                                                                id="confirmNewPswd" name="confirmNewPswd"
                                                                type="password" placeholder="Confirm New Password">
                                                            <small id="confirmPswdError" class="text-danger"></small>
                                                        </div>
                                                        <div class="col-md-12">
                                                            <button type="submit" class="btn btn-fill-out submit"
                                                                name="submit" value="Submit">Reset</button>
                                                        </div>
                                                    </div>
                                                </form>
                                            </div>

                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <script>
        function validateProfileForm() {
            document.getElementById("nameError").innerText = "";
            document.getElementById("phoneError").innerText = "";

            let isValid = true;

            const name = document.getElementById("name").value.trim();
            const phno = document.getElementById("phno").value.trim();

            if (name === "") {
                document.getElementById("nameError").innerText = "Name is required.";
                isValid = false;
            }

            const phonePattern = /^[0-9]{10}$/;
            if (phno === "") {
                document.getElementById("phoneError").innerText = "Phone number is required.";
                isValid = false;
            } else if (!phonePattern.test(phno)) {
                document.getElementById("phoneError").innerText = "Please enter a valid 10-digit phone number.";
                isValid = false;
            }

            return isValid;
        }

        function validatePasswordForm() {
            document.getElementById("pswdError").innerText = "";
            document.getElementById("newPswdError").innerText = "";
            document.getElementById("confirmPswdError").innerText = "";

            let isValid = true;

            const pswd = document.getElementById("pswd").value.trim();
            const newPswd = document.getElementById("newPswd").value.trim();
            const confirmNewPswd = document.getElementById("confirmNewPswd").value.trim();

            if (pswd === "") {
                document.getElementById("pswdError").innerText = "Current password is required.";
                isValid = false;
            }

            if (newPswd === "") {
                document.getElementById("newPswdError").innerText = "New password is required.";
                isValid = false;
            } else if (newPswd.length < 6) {
                document.getElementById("newPswdError").innerText = "New password must be at least 6 characters long.";
                isValid = false;
            }

            if (confirmNewPswd === "") {
                document.getElementById("confirmPswdError").innerText = "Please confirm your new password.";
                isValid = false;
            } else if (newPswd !== confirmNewPswd) {
                document.getElementById("confirmPswdError").innerText = "Passwords do not match.";
                isValid = false;
            }

            return isValid;
        }

    </script>

    <%- include('footer.ejs') %>